CREATE VIEW CF01_Address_Concat_VW  AS  select a.AddressId AS AddressId,a.ObjectId AS ObjectId,a.DocumentTypeId AS DocumentTypeId,a.StreetAddress AS StreetAddress,a.City AS City,(case when (a.CountryId = 1) then State.StateName else a.OptionalState end) AS State,a.PostalCode AS Zip,Country.CountryName AS Country from ((CF01_Address a left join (select s.StateId AS StateId,s.StateName AS StateName from CF01_State_R s) State on((a.StateId = State.StateId))) left join (select c.CountryId AS CountryId,c.CountryName AS CountryName from CF01_Country_R c) Country on((a.CountryId = Country.CountryId))) where (a.IsActive = TRUE) ;
DROP TABLE IF EXISTS `CF01_Brand_Check_VW`;

CREATE VIEW CF01_Brand_Check_VW  AS  select CF01_Brand.CosmeticFormulationId AS CosmeticFormulationId,CF01_Brand.BrandDescription AS BrandDescription from CF01_Brand where (CF01_Brand.IsActive = 1) ;
DROP TABLE IF EXISTS `CF01_Category_VW`;

CREATE VIEW CF01_Category_VW  AS  select c.CategoryId AS CategoryId,c.CategoryTypeId AS CategoryTypeId,c.CategoryCode AS CategoryCode,ct.CategoryTypeDescription AS CategoryTypeDescription,c.CategoryDescription AS CategoryDescription,c.CreatedOn AS CreatedOn,c.CreatedBy AS CreatedBy,c.ModifiedOn AS ModifiedOn,c.ModifiedBy AS ModifiedBy,c.IsActive AS IsActive from (CF01_Category_R c left join CF01_CategoryType_R ct on((c.CategoryTypeId = ct.CategoryTypeId))) ;
DROP TABLE IF EXISTS `CF01_Company_Filer_VW`;

CREATE VIEW CF01_Company_Filer_VW  AS  select c.CompanyId AS CompanyId,c.CompanyName AS CompanyName,c.FirstName AS CompanyFirstName,c.LastName AS CompanyLastName,c.UserName AS UserName,c.Email AS CompanyEmail,f.FirstName AS FilerFirstName,f.LastName AS FilerLastName,f.Email AS FilerEmail,c.`Status` AS `Status` from (CF01_Company c left join CF01_Filer f on(((c.CompanyId = f.CompanyId) and (f.IsActive = 1)))) where (c.IsActive = 1) ;
DROP TABLE IF EXISTS `CF01_Company_VW`;

CREATE VIEW CF01_Company_VW  AS  select CF01_Company.CompanyId AS CompanyId,CF01_Company.CompanyName AS CompanyName,CF01_Company.FirstName AS FirstName,CF01_Company.LastName AS LastName,CF01_Company.JobTitle AS JobTitle,CF01_Company.Country AS Country,CF01_Company.UserName AS UserName,CF01_Company.Phone AS Phone,CF01_Company.Email AS Email,CF01_Company.`Status` AS `Status`,CF01_Company.IsActive AS IsActive from CF01_Company ;
DROP TABLE IF EXISTS `CF01_CosmeticEstablishment_VW`;

CREATE VIEW CF01_CosmeticEstablishment_VW  AS  select ce.CosmeticEstablishmentId AS CosmeticEstablishmentId,ce.CompanyId AS CompanyId,ce.StatusId AS StatusId,ce.AuthorizedIndividualId AS AuthorizedIndividualId,ce.AlternativeAuthorizedIndividualId AS AlternativeAuthorizedIndividualId,ce.EstablishmentType AS EstablishmentType,ce.RegistrationNumber AS RegistrationNumber,ce.ParentCompany AS ParentCompany,ce.EstablishmentName AS EstablishmentName,ce.IsOwnerOperator AS IsOwnerOperator,ce.IsTheAddressManufacturingOrPacking AS IsTheAddressManufacturingOrPacking,ce.AuthorizedIndividualDate AS AuthorizedIndividualDate,ce.AlternativeAuthorizedIndividualDate AS AlternativeAuthorizedIndividualDate,ce.RegisteredDate AS RegisteredDate,ce.ApprovedDate AS ApprovedDate,ce.ApprovedBy AS ApprovedBy,ce.DiscontinuedDate AS DiscontinuedDate,ce.AmendedDate AS AmendedDate,ce.VerifiedDate AS VerifiedDate,ce.IsOnHold AS IsOnHold,ce.IsPaperFiling AS IsPaperFiling,ce.ModifiedBy AS ModifiedBy,co.CompanyName AS CompanyName,st.StatusDescription AS StatusDescription,fi.FirstName AS AuthorizedIndividualFirstName,fi.LastName AS AuthorizedIndividualLastName,fi.Email AS AuthorizedIndividualEmail,fial.FirstName AS AlternativeAuthorizedIndividualFirstName,fial.LastName AS AlternativeAuthorizedIndividualLastName,fial.Email AS AlternativeAuthorizedIndividualEmail,`add`.AddressId AS AddressId,`add`.StateId AS StateId,state.StateCode AS StateCode,state.StateName AS StateName,`add`.CountryId AS CountryId,country.CountryCode AS CountryCode,country.CountryName AS CountryName,`add`.StreetAddress AS StreetAddress,`add`.City AS City,`add`.PostalCode AS PostalCode,`add`.OptionalState AS OptionalState,`add`.IsPrimary AS IsPrimary,ce.IsActive AS IsActive from (((((((CF01_CosmeticEstablishment ce left join CF01_Company co on((ce.CompanyId = co.CompanyId))) left join CF01_Status_R st on((ce.StatusId = st.StatusId))) left join CF01_Filer fi on((ce.AuthorizedIndividualId = fi.FilerId))) left join CF01_Filer fial on((ce.AlternativeAuthorizedIndividualId = fial.FilerId))) left join CF01_Address `add` on(((ce.CosmeticEstablishmentId = `add`.ObjectId) and (`add`.DocumentTypeId = 1) and (`add`.IsActive = 1)))) left join CF01_State_R state on((`add`.StateId = state.StateId))) left join CF01_Country_R country on((`add`.CountryId = country.CountryId))) where (ce.IsActive = 1) ;
DROP TABLE IF EXISTS `CF01_Filer_VW`;

CREATE VIEW CF01_Filer_VW  AS  select CF01_Filer.FilerId AS FilerId,CF01_Filer.CompanyId AS CompanyId,CF01_Filer.FirstName AS FirstName,CF01_Filer.LastName AS LastName,CF01_Filer.Title AS Title,CF01_Filer.Email AS Email,CF01_Filer.Phone AS Phone,CF01_Filer.IsActive AS IsActive,CF01_Filer.PrimaryFiler AS PrimaryFiler from CF01_Filer ;
DROP TABLE IF EXISTS `CF01_Frequent_Ingredient_VW`;

CREATE VIEW CF01_Frequent_Ingredient_VW  AS  select ic.Id AS Id,ic.CompanyId AS CompanyId,ic.IngredientId AS IngredientId,ic.IsHidden AS IsHidden,ic.`Status` AS `Status`,count(ic.IngredientId) AS TotalCount from CF01_Ingredient_CosmeticFormulation ic where ((ic.IsActive = 1) and (ic.IngredientId is not null)) group by ic.IngredientId,ic.CompanyId order by TotalCount ;
DROP TABLE IF EXISTS `CF01_Info_Renewal_2511_VW`;

CREATE VIEW CF01_Info_Renewal_2511_VW  AS  select a.CosmeticEstablishmentId AS CosmeticEstablishmentId,a.CompanyId AS CompanyId,a.RegistrationNumber AS RegistrationNumber,a.EstablishmentName AS EstablishmentName,a.RegisteredDate AS RegisteredDate,a.VerifiedDate AS VerifiedDate,b.StateId AS StateId,b.CountryId AS CountryId,b.StreetAddress AS StreetAddress,b.City AS City,b.PostalCode AS PostalCode,e.StateName AS StateName,f.CountryName AS CountryName,b.OptionalState AS OptionalState,a.IsActive AS IsActive,c.StatusDescription AS StatusDescription,a.StatusId AS StatusId,a.IsPaperFiling AS IsPaperFiling from (((((CF01_CosmeticEstablishment a left join CF01_Address b on(((b.DocumentTypeId = 1) and (b.ObjectId = a.CosmeticEstablishmentId) and (b.IsActive = 1)))) left join CF01_Status_R c on(((a.StatusId = c.StatusId) and (c.IsActive = 1)))) left join CF01_State_R e on((e.StateId = b.StateId))) left join CF01_Country_R f on((f.CountryId = b.CountryId))) left join CF01_Company company on(((a.CompanyId = company.CompanyId) and (company.IsActive = 1)))) where ((a.IsActive = 1) and (company.Email is not null) and (company.Email <> '')) ;
DROP TABLE IF EXISTS `CF01_Ingredient_Product_VW`;

CREATE VIEW CF01_Ingredient_Product_VW  AS  select ccf.CosmeticFormulationId AS CosmeticFormulationId,ccf.RegistrationNumber AS RegistrationNumber,ccf.IsCommerciallyDistributed AS IsCommerciallyDistributed,cb.BrandDescription AS BrandDescription,cc.CompanyName AS CompanyName,cicf.IngredientName AS IngredientName,crq.IsFDACosmetic AS IsFDACosmetic,ccr.CategoryCode AS CategoryCode,ccr.CategoryDescription AS CategoryDescription from (((((CF01_CosmeticFormulation ccf left join CF01_Brand cb on((ccf.CosmeticFormulationId = cb.CosmeticFormulationId))) left join CF01_Company cc on((ccf.CompanyId = cc.CompanyId))) left join CF01_Ingredient_CosmeticFormulation cicf on((ccf.CosmeticFormulationId = cicf.CosmeticFormulationId))) left join CF01_ResearchQuestion crq on((ccf.CosmeticFormulationId = crq.CosmeticFormulationId))) left join CF01_Category_R ccr on((ccf.CategoryId = ccr.CategoryId))) ;
DROP TABLE IF EXISTS `CF01_Ingredient_Search_VW`;

CREATE VIEW CF01_Ingredient_Search_VW  AS  select CF01_Ingredient_R.IngredientId AS IngredientId,CF01_Ingredient_R.CalcCAS AS IngredientCAS,CF01_Ingredient_R.IngredientName AS IngredientName from CF01_Ingredient_R union select CF01_Ingredient_Synonym_R.IngredientId AS IngredientId,CF01_Ingredient_Synonym_R.CalcCAS AS IngredientCAS,CF01_Ingredient_Synonym_R.IngredientName AS IngredientName from CF01_Ingredient_Synonym_R ;
DROP TABLE IF EXISTS `CF01_Ingredient_Synonym_Concat_VW`;

CREATE VIEW CF01_Ingredient_Synonym_Concat_VW  AS  select i.IngredientId AS IngredientId,i.DisplayCAS AS DisplayCAS,i.OriginalCAS AS OriginalCAS,i.CalcCAS AS CalcCAS,i.TypeId AS TypeId,i.IngredientName AS IngredientName,i.IsHidden AS IsHidden,i.`Status` AS `Status`,i.CreatedOn AS CreatedOn,i.CreatedBy AS CreatedBy,i.ModifiedOn AS ModifiedOn,i.ModifiedBy AS ModifiedBy,i.IsActive AS IsActive,group_concat(s.IngredientName separator ',') AS Synonyms from (CF01_Ingredient_R i left join CF01_Ingredient_Synonym_R s on(((i.IngredientId = s.IngredientId) and (s.IsActive = 1)))) where (i.IsActive = 1) group by i.IngredientId order by length(i.IngredientName) ;
DROP TABLE IF EXISTS `CF01_Ingredient_Synonym_Union_VW`;

CREATE VIEW CF01_Ingredient_Synonym_Union_VW  AS  select i.IngredientId AS IngredientId,i.DisplayCAS AS DisplayCAS,i.OriginalCAS AS OriginalCAS,i.CalcCAS AS CalcCAS,i.TypeId AS TypeId,i.IngredientName AS IngredientName,i.IsHidden AS IsHidden,i.`Status` AS `Status`,i.CreatedOn AS CreatedOn,i.CreatedBy AS CreatedBy,i.ModifiedOn AS ModifiedOn,i.ModifiedBy AS ModifiedBy,i.IsActive AS IsActive,0 AS IsSynonym from CF01_Ingredient_R i where (i.IsActive = 1) union select s.SynonymId AS IngredientId,s.DisplayCAS AS DisplayCAS,s.OriginalCAS AS OriginalCAS,s.CalcCAS AS CalcCAS,s.TypeId AS TypeId,s.IngredientName AS IngredientName,s.IsHidden AS IsHidden,s.`Status` AS `Status`,s.CreatedOn AS CreatedOn,s.CreatedBy AS CreatedBy,s.ModifiedOn AS ModifiedOn,s.ModifiedBy AS ModifiedBy,s.IsActive AS IsActive,s.IsSynonym AS IsSynonym from CF01_Ingredient_Synonym_R s where (s.IsActive = 1) ;
DROP TABLE IF EXISTS `CF01_Labeler_Merge_VW`;

CREATE VIEW CF01_Labeler_Merge_VW  AS  select l.LabelerId AS LabelerId,l.LabelerNumber AS LabelerNumber,(case when (l.CompanyId = 0) then m.CompanyId else l.CompanyId end) AS CompanyId,l.StatusId AS StatusId,str.StatusDescription AS StatusDescription,l.LabelerName AS LabelerName,a.AddressId AS AddressId,a.StateId AS StateId,sr.StateCode AS StateCode,sr.StateName AS StateName,a.CountryId AS CountryId,cr.CountryCode AS CountryCode,cr.CountryName AS CountryName,a.DocumentTypeId AS DocumentTypeId,a.ObjectId AS ObjectId,a.StreetAddress AS StreetAddress,a.City AS City,a.PostalCode AS PostalCode,a.OptionalState AS OptionalState,a.IsPrimary AS IsPrimary,a.CreatedOn AS AddressCreatedOn,a.CreatedBy AS AddressCreatedBy,a.ModifiedOn AS AddressModifiedOn,a.ModifiedBy AS AddressModifiedBy,a.IsActive AS AddressIsActive,l.CreatedOn AS LabelerCreatedOn,l.CreatedBy AS LabelerCreatedBy,l.ModifiedOn AS LabelerModifiedOn,l.ModifiedBy AS LabelerModifiedBy,l.IsActive AS LabelerIsActive,1 AS LabelerId_Count from (((((CF01_Labeler l left join CF01_Address a on(((a.ObjectId = l.LabelerId) and (a.DocumentTypeId = 3) and (a.IsActive = 1)))) left join CF01_State_R sr on((a.StateId = sr.StateId))) left join CF01_Country_R cr on((a.CountryId = cr.CountryId))) left join CF01_Status_R str on((l.StatusId = str.StatusId))) left join CF01_Labeler_Merge m on(((l.LabelerId = m.LabelerId) and (m.IsActive = 1)))) where ((l.StatusId <> 100) and (l.IsActive = 1)) ;
DROP TABLE IF EXISTS `CF01_REPORT_2512_Ingredient_Product_VW`;

CREATE VIEW CF01_REPORT_2512_Ingredient_Product_VW  AS  select cf.CosmeticFormulationId AS CosmeticFormulationId,cf.RegistrationNumber AS RegistrationNumber,b.Brands AS Brands,stat.StatusId AS StatusId,stat.StatusDescription AS StatusDescription,comp.CompanyId AS CompanyId,comp.CompanyName AS CompanyName,icf.IngredientIds AS IngredientIds,icf.Ingredients AS Ingredients,question.IsFDACosmetic AS IsFDACosmetic,cf.IsCommerciallyDistributed AS IsCommerciallyDistributed,cat.CategoryCode AS CategoryCode,cat.CategoryDescription AS CategoryDescription from ((((((((select CF01_CosmeticFormulation.CosmeticFormulationId AS CosmeticFormulationId,CF01_CosmeticFormulation.RegistrationNumber AS RegistrationNumber,CF01_CosmeticFormulation.StatusId AS StatusId,CF01_CosmeticFormulation.CompanyId AS CompanyId,CF01_CosmeticFormulation.IsCommerciallyDistributed AS IsCommerciallyDistributed,CF01_CosmeticFormulation.CategoryId AS CategoryId from CF01_CosmeticFormulation where ((CF01_CosmeticFormulation.CompanyId is not null) and (CF01_CosmeticFormulation.StatusId <> 100) and (CF01_CosmeticFormulation.StatusId is not null)))) cf left join (select CF01_Brand.CosmeticFormulationId AS CosmeticFormulationId,group_concat(CF01_Brand.BrandDescription separator ',') AS Brands from CF01_Brand where ((CF01_Brand.CosmeticFormulationId is not null) and (CF01_Brand.BrandDescription is not null)) group by CF01_Brand.CosmeticFormulationId) b on((cf.CosmeticFormulationId = b.CosmeticFormulationId))) left join (select CF01_Status_R.StatusId AS StatusId,CF01_Status_R.StatusDescription AS StatusDescription from CF01_Status_R) stat on((cf.StatusId = stat.StatusId))) left join (select CF01_Company.CompanyId AS CompanyId,CF01_Company.CompanyName AS CompanyName from CF01_Company where ((CF01_Company.CompanyId is not null) and (CF01_Company.CompanyName is not null) and (CF01_Company.IsActive = TRUE))) comp on((cf.CompanyId = comp.CompanyId))) left join (select CF01_Ingredient_CosmeticFormulation.CosmeticFormulationId AS CosmeticFormulationId,group_concat(CF01_Ingredient_CosmeticFormulation.IngredientId separator ',') AS IngredientIds,group_concat(CF01_Ingredient_CosmeticFormulation.IngredientName separator ',') AS Ingredients from CF01_Ingredient_CosmeticFormulation where ((CF01_Ingredient_CosmeticFormulation.IngredientName is not null) and (CF01_Ingredient_CosmeticFormulation.IngredientId is not null) and (CF01_Ingredient_CosmeticFormulation.CompanyId is not null) and (CF01_Ingredient_CosmeticFormulation.IsActive = TRUE)) group by CF01_Ingredient_CosmeticFormulation.CosmeticFormulationId) icf on((cf.CosmeticFormulationId = icf.CosmeticFormulationId))) left join (select CF01_ResearchQuestion.CosmeticFormulationId AS CosmeticFormulationId,CF01_ResearchQuestion.IsFDACosmetic AS IsFDACosmetic from CF01_ResearchQuestion) question on((cf.CosmeticFormulationId = question.CosmeticFormulationId))) left join (select CF01_Category_R.CategoryId AS CategoryId,CF01_Category_R.CategoryCode AS CategoryCode,CF01_Category_R.CategoryDescription AS CategoryDescription from CF01_Category_R) cat on((cf.CategoryId = cat.CategoryId))) ;
DROP TABLE IF EXISTS `CF01_REPORT_Account_VW`;

CREATE VIEW CF01_REPORT_Account_VW  AS  select f.FilerId AS FilerId,c.CompanyId AS CompanyId,c.CompanyName AS CompanyName,concat(c.FirstName,' ',c.LastName) AS AccountName,c.FirstName AS CompanyFirstName,c.LastName AS CompanyLastName,c.JobTitle AS CompanyJobTitle,c.Country AS Country,c.UserName AS UserName,c.Phone AS Phone,c.Email AS CompanyEmail,c.AlternateEmail AS AlternateEmail,c.`Status` AS `Status`,(case when (c.`Status` > 2) then 'Paper' else 'Online' end) AS AccountType,(case when (c.`Status` = 1) then 'Accepted' when (c.`Status` = 0) then 'New' when (c.`Status` = -(1)) then 'Rejected' when (c.`Status` = -(2)) then 'Duplicated' when (c.`Status` = -(3)) then 'Not a responsible employee' else '' end) AS StatusDescription,c.Fax AS Fax,cast(c.CreatedOn as date) AS CompanyCreatedOn,c.CreatedBy AS CompanyCreatedBy,c.ModifiedOn AS CompanyModifiedOn,c.ModifiedBy AS CompanyModifiedBy,c.IsActive AS CompanyIsActive,f.FirstName AS FilerFirstName,f.LastName AS FilerLastName,f.Title AS FilerJobTitle,group_concat(f.Email separator '; ') AS FilerEmail,f.CreatedOn AS FilerCreatedOn,f.CreatedBy AS FilerCreatedBy,f.ModifiedOn AS FilerModifiedOn,f.ModifiedBy AS FilerModifiedBy,f.IsActive AS FilerIsActive,audit.LastModified AS LastAction from ((CF01_Company c left join CF01_Filer f on(((c.CompanyId = f.CompanyId) and (f.IsActive = 1)))) left join ((select max(ce.CreatedOn) AS LastModified,ce.CreatedBy AS extusername from CF01_AUDIT_SUM_2511 ce group by ce.CreatedBy) union (select max(cf.CreatedOn) AS `MAX(CreatedOn)`,cf.CreatedBy AS CreatedBy from CF01_AUDIT_SUM_2512 cf group by cf.CreatedBy)) audit on((c.UserName = audit.extusername))) where (c.IsActive = 1) group by c.CompanyId ;
DROP TABLE IF EXISTS `CF01_REPORT_Brand_VW`;

CREATE VIEW CF01_REPORT_Brand_VW  AS  select b.BrandDocumentId AS BrandId,cf.CosmeticFormulationId AS CosmeticFormulationId,cf.RegistrationNumber AS RegistrationNumber,cf.RegisteredDate AS RegisteredDate,cf.ApprovedDate AS ApprovedDate,cf.VerifiedDate AS VerifiedDate,cf.DiscontinuedDate AS DiscontinuedDate,cf.ModifiedOn AS ModifiedOn,cf.StatusId AS StatusId from (CF01_Brand b join CF01_CosmeticFormulation cf on(((cf.CosmeticFormulationId = b.CosmeticFormulationId) and (b.IsActive = 1)))) where (cf.IsActive = 1) ;
DROP TABLE IF EXISTS `CF01_REPORT_Labeler_VW`;

CREATE VIEW CF01_REPORT_Labeler_VW  AS  select l.LabelerId AS LabelerId,l.ModifiedOn AS LabelerModifiedOn,l.StatusId AS LabelerStatusId,cf.CosmeticFormulationId AS CosmeticFormulationId,cf.CompanyId AS CompanyId,cf.RegistrationNumber AS RegistrationNumber,cf.RegisteredDate AS RegisteredDate,cf.ApprovedDate AS ApprovedDate,cf.VerifiedDate AS VerifiedDate,cf.DiscontinuedDate AS DiscontinuedDate,cf.ModifiedOn AS ModifiedOn,cf.StatusId AS StatusId from (CF01_Labeler l join CF01_CosmeticFormulation cf on(((cf.LabelerId = l.LabelerId) and (l.IsActive = 1)))) where (cf.IsActive = 1) ;
DROP TABLE IF EXISTS `CF01_Return_Company_VW`;

CREATE VIEW CF01_Return_Company_VW  AS  select S.CosmeticFormulationId AS CosmeticFormulationId,V.CompanyName AS companyname from (CF01_CosmeticFormulation S left join CF01_Company V on((S.CompanyId = V.CompanyId))) ;
DROP TABLE IF EXISTS `CF01_Unused_Ingredient_VW`;
DROP TABLE IF EXISTS `OC01_PAT_Advocate_Data_Export`;

USE cf01_test;
CREATE VIEW CF01_Unused_Ingredient_VW AS select `Ingredient`.`IngredientId` AS `IngredientId`,`Ingredient`.`DisplayCAS` AS `DisplayCAS`,`Ingredient`.`OriginalCAS` AS `OriginalCAS`,`Ingredient`.`CalcCAS` AS `CalcCAS`,`Ingredient`.`TypeId` AS `TypeId`,`Ingredient`.`IngredientName` AS `IngredientName`,`Ingredient`.`IsHidden` AS `IsHidden`,`Ingredient`.`Status` AS `Status`,`Ingredient`.`CreatedOn` AS `CreatedOn`,`Ingredient`.`CreatedBy` AS `CreatedBy`,`Ingredient`.`ModifiedOn` AS `ModifiedOn`,`Ingredient`.`ModifiedBy` AS `ModifiedBy`,`Ingredient`.`IsActive` AS `IsActive` from (((select `CF01_Ingredient_R`.`IngredientId` AS `IngredientId`,`CF01_Ingredient_R`.`DisplayCAS` AS `DisplayCAS`,`CF01_Ingredient_R`.`OriginalCAS` AS `OriginalCAS`,`CF01_Ingredient_R`.`CalcCAS` AS `CalcCAS`,`CF01_Ingredient_R`.`TypeId` AS `TypeId`,`CF01_Ingredient_R`.`IngredientName` AS `IngredientName`,`CF01_Ingredient_R`.`IsHidden` AS `IsHidden`,`CF01_Ingredient_R`.`Status` AS `Status`,`CF01_Ingredient_R`.`CreatedOn` AS `CreatedOn`,`CF01_Ingredient_R`.`CreatedBy` AS `CreatedBy`,`CF01_Ingredient_R`.`ModifiedOn` AS `ModifiedOn`,`CF01_Ingredient_R`.`ModifiedBy` AS `ModifiedBy`,`CF01_Ingredient_R`.`IsActive` AS `IsActive` from `CF01_Ingredient_R`)) `Ingredient` left join (select `icfTemp`.`IngredientId` AS `IngredientId` from (((select `CF01_CosmeticFormulation`.`CosmeticFormulationId` AS `CosmeticFormulationId` from `CF01_CosmeticFormulation` where ((`CF01_CosmeticFormulation`.`CompanyId` is not null) and (`CF01_CosmeticFormulation`.`StatusId` = 109) and (`CF01_CosmeticFormulation`.`IsActive` = TRUE)))) `cf` left join (select `CF01_Ingredient_CosmeticFormulation`.`CosmeticFormulationId` AS `CosmeticFormulationId`,`CF01_Ingredient_CosmeticFormulation`.`IngredientId` AS `IngredientId` from `CF01_Ingredient_CosmeticFormulation` where ((`CF01_Ingredient_CosmeticFormulation`.`CompanyId` is not null) and (`CF01_Ingredient_CosmeticFormulation`.`IngredientId` is not null))) `icfTemp` on((`icfTemp`.`CosmeticFormulationId` = `cf`.`CosmeticFormulationId`))) where (`icfTemp`.`CosmeticFormulationId` is not null) group by `icfTemp`.`IngredientId`) `icf` on((`Ingredient`.`IngredientId` = `icf`.`IngredientId`))) where isnull(`icf`.`IngredientId`);